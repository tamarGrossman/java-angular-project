<div class="challenge-details-container">
 
 @if (isLoading) {
  <div class="loading-message">
   <p>注 驻专 转专...  转.</p>
  </div>
 }

 @if (challenge) { 
    <div class="challenge-card">
   
   <header class="card-header">
    <h1 class="challenge-name">{{ challenge.name }}</h1>
   </header>

   <div class="card-body">
    
            <div class="description-box">
      <p class="description-title">转专 转专:</p>
      <p class="challenge-description">{{ challenge.description }}</p>
    </div>
    
    @if (challenge.picture) {
             <div class="image-container">
      <img 
       [src]="'data:image/jpeg;base64,' + challenge.picture" 
       [alt]="'转转 转专: ' + challenge.name" 
       class="challenge-image"
      />
     </div>
    }
    
    <hr>

    <div class="challenge-meta">
     <p><strong>砖 :</strong> {{ challenge.numOfDays }} </p>
     <p><strong>转专 爪专:</strong> {{ challenge.date | date: 'dd/MM/yyyy' }}</p>
     <p><strong>爪专 注 :</strong> {{ challenge.userName }}</p>
    </div>
    
        </div>
       </div> 
  
      <div class="like-and-buttons-section">
    <app-challenge-like
      [challengeId]="challenge.id"
      [initialIsLiked]="challenge.isLikedByCurrentUser === true"
      [initialLikeCount]="challenge.likeCount || 0"
      (likeStatusChanged)="onLikeStatusUpdated($event)">
    </app-challenge-like>
    
    <div class="action-buttons">
      <button [routerLink]="['/challenges']" class="back-button">  转专 </button>
      <button 
        (click)="joinChallenge()" 
        [disabled]="isJoining" 
        class="btn btn-primary join-button">
        {{ isJoining ? '爪专祝...' : '爪专祝 转专' }}
      </button>
    </div>
  </div>
  
  @if (commentSuccessMessage) {
    <div class="comment-success-toast">
      {{ commentSuccessMessage }}
    </div>
  }

      @if (showCommentForm) {
    <div class="add-comment-wrapper">
      <app-add-comment 
        [challengeId]="challenge.id" 
        (commentAdded)="onCommentAddedSuccess()">
      </app-add-comment>
    </div>
  }
  
      <div class="comments-section">
      <h3> 转转 转专 ({{ comments?.length || 0 }})</h3>

   <hr>

   @for (comment of comments; track comment.id) {
    
    <div class="comment-item">
     <div class="comment-header">
      <strong>{{ comment.username }}</strong>
      
      <span class="comment-date">驻专住 : {{ comment.date | date: 'dd/MM/yyyy' }}</span>
     </div>

     <p class="comment-content">{{ comment.content }}</p>

     @if (comment.picture) {
      <div class="comment-image-container">
       <img [src]="'data:image/jpeg;base64,' + comment.picture" 
         alt="转 砖爪专驻 转" 
         class="comment-image">
      </div>
     }

     <hr>
    </div>

   } @empty {
    <p> 注 转转 转专 .  专砖 !</p>
   }
  </div>
          
  } @else if (!isLoading) { 
  <div class="error-message">
    <h2>404 - 转专  爪</h2>
    <p>爪注专,  爪 爪 转 转专 注  {{ challengeId }}.</p>
  </div>
  
 }
</div>