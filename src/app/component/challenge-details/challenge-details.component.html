<div class="challenge-details-container">
 
 @if (isLoading) {
  <div class="loading-message">
   <p>注 驻专 转专...  转.</p>
  </div>
 }

 @if (challenge) {
  <div class="challenge-card">
   
   <header class="card-header">
    <h1 class="challenge-name">{{ challenge?.name }}</h1>
   </header>

   <div class="card-body">
    
    @if (challenge.picture) {
     <div class="image-container">
      <img 
       [src]="'data:image/jpeg;base64,' + challenge.picture" 
       [alt]="'转转 转专: ' + challenge.name" 
       class="challenge-image"
      />
     </div>
    }
    
@if (challenge) {
  <app-challenge-like
            [challengeId]="challenge.id ?? 0"
   
            [initialIsLiked]="challenge.isLikedByCurrentUser"
    [initialLikeCount]="challenge.likeCount"
   
    (likeStatusChanged)="onLikeStatusUpdated($event)"
  ></app-challenge-like>
}
        
    <p class="description-title">转专 转专:</p>
    <p class="challenge-description">{{ challenge.description }}</p>
    
    <hr>

    <div class="challenge-meta">
     <p><strong>:</strong> {{ challenge.id }}</p>
     <p><strong>砖 :</strong> {{ challenge.numOfDays }} </p>
     <p><strong>转专 爪专:</strong> {{ challenge.date | date: 'dd/MM/yyyy' }}</p>
     <p><strong>爪专 注 :</strong> {{ challenge.userName }}</p>
     
     <button [routerLink]="['/challenges']" class="back-button">专 专砖转 转专</button>

    </div>

    <div class="comment-actions-group">
      <button (click)="toggleCommentForm()" class="btn btn-secondary toggle-button">
        @if (showCommentForm) {
          住转专 驻住 转
        } @else {
          住祝 转 (拽) 锔
        }
      </button>
      
      <button 
        [routerLink]="['/add-comment', challenge.id]" 
        class="btn btn-info navigate-button">
         注 转 砖
      </button>
    </div>
       </div>
  </div>
@if (showCommentForm) {
  <div class="add-comment-section">
    <app-add-comment 
      [challengeId]="challenge.id" 
      (commentAdded)="onCommentAddedSuccess()">
    </app-add-comment>
  </div>
}
  
  <div class="comments-section">
   <h3> 转转 转专 ({{ comments.length }})</h3>

   <hr>

   @for (comment of comments; track comment.id) {
    
    <div class="comment-item">
     <div class="comment-header">
      <strong>{{ comment.username }}</strong>
      
      <span class="comment-date">驻专住 : {{ comment.date | date: 'dd/MM/yyyy' }}</span>
     </div>

     <p class="comment-content">{{ comment.content }}</p>

     @if (comment.picture) {
      <div class="comment-image-container">
       <img [src]="'data:image/jpeg;base64,' + comment.picture" 
         alt="转 砖爪专驻 转" 
         class="comment-image">
      </div>
     }

     <hr>
    </div>

   } @empty {
    <p> 注 转转 转专 .  专砖 !</p>
   }
  </div>
     } @else if (!isLoading) { 
  <div class="error-message">
    <h2>404 - 转专  爪</h2>
    <p>爪注专,  爪 爪 转 转专 注  {{ challengeId }}.</p>
  </div>
  
 }
 
  <button 
  (click)="joinChallenge()" 
  [disabled]="isJoining" 
  class="btn btn-primary join-button">
  {{ isJoining ? '爪专祝...' : '爪专祝 转专' }}
 </button>

</div>