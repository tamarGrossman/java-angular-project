<div class="popular-section">
    <h2 class="section-title">××ª×’×¨×™× ×¤×•×¤×•×œ×¨×™×™× </h2>

    @if (isLoading) {
        <div class="loading">×˜×•×¢×Ÿ ××ª×’×¨×™× ×¤×•×¤×•×œ×¨×™×™×...</div>
    }

    <div class="carousel-container">

        <div class="carousel-track"
            [style.transform]="'translateX(-' + (currentIndex * (100 / itemsToShow)) + '%)'">

            @for (challenge of popularChallenges; track challenge.id) {
                <div class="carousel-slide" [style.width.%]="100 / itemsToShow">

                    <div class="modern-card" [routerLink]="['/challenge', challenge.id]">

                        @if (challenge.picture && challenge.picture.length > 100) {
                            <div class="card-image">
                                <img 
                                    [src]="challenge.picture" 
                                    [alt]="'×ª××•× ×ª ××ª×’×¨: ' + challenge.name" 
                                    class="challenge-image"
                                /> 
                                <span class="days-badge">{{ challenge.numOfDays }} ×™××™×</span> 
                            </div>
                        } @else {
                            <div class="no-image-placeholder">
                                <span class="placeholder-icon">ğŸ—“ï¸</span>
                               <h3>{{ challenge.numOfDays }}</h3>    <h3>×™××™×</h3> 
                                </div>
                        } 

                        <div class="card-content">
                            <h3 class="card-title">{{ challenge.name }}</h3> 
                            <p class="card-description">{{ challenge.description | slice:0:75 }}...</p>

                            <div class="card-footer">
                                <div class="date-info">
                                    <span class="start-date">×”×•×¢×œ×” ×‘- {{ challenge.date | date:'dd.MM' }}</span>
                                </div>

                                <div class="likes-info">
                                    <span class="heart">â¤ï¸</span>
                                    <strong>{{ challenge.likeCount }}</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            }

            @for (i of emptySlides(); track i) {
                <div class="carousel-slide" [style.width.%]="100 / itemsToShow">
                    <div class="modern-card dummy-card"></div>
                </div>
            }

        </div>

        <button class="nav-btn prev" (click)="prev()" [disabled]="currentIndex === 0">â€¹</button>
        <button class="nav-btn next" (click)="next()" [disabled]="currentIndex >= maxIndex()">â€º</button>
        
        <div class="dots">
            @for (n of getDots(); track $index) {
                <span class="dot" [class.active]="currentIndex === $index" (click)="goToSlide($index)"></span>
            }
        </div>
    </div>
</div>